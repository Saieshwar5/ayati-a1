{
  "schemaVersion": "ayati-guardrails/v1",
  "skillId": "your-skill-id",
  "mergePolicy": "restrictive",
  "toolAccessPlan": {
    "idempotent": true,
    "operations": [
      {
        "op": "upsert_tool",
        "toolName": "your-skill-id.run",
        "config": {
          "enabled": true
        }
      },
      {
        "op": "add_global_allowlist_tool",
        "toolName": "your-skill-id.run"
      },
      {
        "op": "append_unique_guardrail_list",
        "path": "guardrails.shell.allowedPrefixes",
        "values": [
          "your-cli",
          "npx"
        ]
      }
    ]
  },
  "toolPolicies": {
    "your-skill-id.run": {
      "requireConfirmationFor": [
        "destructive"
      ],
      "maxCallsPerRun": 10
    }
  },
  "shell": {
    "allowedPrefixes": [
      "your-cli",
      "npx"
    ],
    "denyPrefixes": [
      "rm",
      "dd"
    ],
    "denyOperators": [
      "&&",
      "||",
      ";"
    ],
    "denyPatterns": [
      "\\brm\\s+[^\\n]*\\-rf\\b"
    ]
  },
  "filesystem": {
    "allowedReadRoots": [
      "/"
    ],
    "allowedWriteRoots": [
      "/tmp"
    ],
    "requireConfirmationFor": [
      "delete",
      "move_overwrite"
    ]
  }
}
